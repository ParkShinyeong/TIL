### React 상태 관리

React는 상태 관리를 위한 라이브러리는 아니다!

But, 상태 관리의 주요 원칙을 배우고 이를 따라간다면, 컴포넌트 간 서로 느슨하게 결합된, 구조적으로 아름다운 코드를 작성할 수 있다.

**상태 : UI에 동적으로 표현될 데이터**

**Side Effect : 함수(또는 컴포넌트)의 입력 외에도 함수의 결과에 영향을 미치는 요인 (ex) 백엔드 API 요청)**

상태를 다룰 때 Side Effect는 주요 고려 대상이다.

컴포넌트를 만들 때에는 굳이 fetch 없이 fake data라도 표현할 수 있어야 한다. 컴포넌트는 표현 그 자체에 집중한다. (presentation 컴포넌트)

그러나 앱을 제작할 때는 API 호출도 있어야 하고, side effect는 불가피하게 생기게 된다.

ex) side effect에 의존적인 상태 ⇒ 데이터 로딩 여부 (로딩 창) 등이 있다.

#

### 상태의 적절한 위치는?

**1. 로컬**

특정 컴포넌트 안에서만 관리되는 상태

보통 컴포넌트 내에서만 영향을 끼친다.

다른 컴포넌트와 데이터를 공유하지 않는다.

ex) input box, select box

**2.전역**

프로덕트 전체/ 여러 컴포넌트에서 관리되는 상태

다른 컴포넌트와 상태를 공유하고 영향을 끼친다.

ex) 로딩 여부, 다크 모드 테마, globalization , photoshop의 Undo/Redo를 위한 history 기능

##

서로 다른 컴포넌트가 사용하는 상태가 다르면, 서로 다른 출처가 있어도 상관없지만, 컴포넌트가 **서로 동일한 상태**를 다룰 때에는 서로 다른 출처로부터 가져오는 것은 피해야 한다. 즉 **출처는 오직 한 곳(전역 공간)**이어야 한다.

만일 사본이 있을 경우, 두 데이터는 서로 동기화하는 과정이 필요하고, (하나가 바뀌면 다른 하나도 바뀌어야 한다. ) 이는 문제를 해결하기 어렵다.

따라서 **한 곳에만 상태를 저장하고 접근 하는 것이 좋다!**

#

### 데이터 무결성?

데이터의 정확성을 보장하기 위해 데이터의 변경이나 수정 시 제한을 두어 안정성을 저해하는 요소를 막고 데이터 상태를 항상 옳게 유지하는 것

**무결성을 위한 방법론** ⇒ 동일한 데이터는 항상 같은 곳에서 데이터를 가지고 온다. (Single source of truth - 신뢰할 수 있는 단일 출처) )

#

### 상태 관리 툴

- React Context
- Redux
- MobX

→ **전역 상태 저장소를 제공**하여 문제를 해결해준다.

→**props drilling 문제를 해결**해준다.

[a] - [b] - [c] - [d]라는 컴포넌트들이 있고,[a]에서 상태가 있고, [d]에서 해당 상태를 사용한다고 하면, 그 중간의 [b], [c] 등은 굳이 상태가 필요하지 않아도, props를 만들어 자식 컴포넌트에 넘겨주어야 했다. 이를 props drilling(프로퍼티 내려꽂기) 문제라고 부른다.
